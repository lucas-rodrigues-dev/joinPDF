<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Juntar PDFs</title>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
</head>
<body>
    <h1>Juntar até 4 arquivos PDFs</h1>
    
    <!-- Formulário para upload -->
    <form id="upload-form">
        <label for="pdfs">Selecione os PDFs (mínimo 2, máximo 4):</label>
        <input type="file" id="pdfs" accept="application/pdf" multiple required><br><br>

        <button type="submit">Juntar PDFs</button>
    </form>

    <br>
    <a id="download-link" style="display: none;" href="#" download="arquivo_combinado.pdf">Baixar PDF Combinado</a>

    <script>
        // Função para juntar múltiplos PDFs
        async function juntarPdfs(files) {
            const pdfDoc = await PDFLib.PDFDocument.create();

            for (let file of files) {
                const pdfBytes = await file.arrayBuffer();
                const pdfDocTemp = await PDFLib.PDFDocument.load(pdfBytes);
                const copiedPages = await pdfDoc.copyPages(pdfDocTemp, pdfDocTemp.getPageIndices());
                
                copiedPages.forEach((page) => pdfDoc.addPage(page));
            }

            // Serializar o documento PDF combinado
            return await pdfDoc.save();
        }

        // Manipular o formulário de upload
        document.getElementById('upload-form').addEventListener('submit', async (event) => {
            event.preventDefault();
            
            const files = document.getElementById('pdfs').files;
            
            if (files.length < 2 || files.length > 4) {
                alert("Por favor, selecione entre 2 e 4 arquivos PDF.");
                return;
            }

            try {
                // Juntar os PDFs
                const pdfBytes = await juntarPdfs(files);

                // Criar um link para download
                const downloadLink = document.getElementById('download-link');
                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                downloadLink.href = URL.createObjectURL(blob);
                downloadLink.style.display = 'inline';
                downloadLink.innerText = "Baixar PDF Combinado";
            } catch (error) {
                console.error("Erro ao juntar os PDFs:", error);
                alert("Ocorreu um erro ao processar os arquivos.");
            }
        });
    </script>
</body>
</html>
